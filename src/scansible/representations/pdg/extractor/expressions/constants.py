from __future__ import annotations

PURE_LOOKUP_PLUGINS = {
    "config",
    "dict",
    "indexed_items",
    "items",
    "list",
    "nested",
    "sequence",
    "subelements",
    "together",
    "cartesian",
    # TODO: Is `env` really pure? It might not be, but it leads to a lot of false positives.
    "env",
}

PURE_FILTERS = {
    # Jinja2 built-in
    "abs",
    "attr",
    "batch",
    "capitalize",
    "center",
    "default",
    "d",
    "dictsort",
    "escape",
    "e",
    "filesizeformat",
    "first",
    "float",
    "forceescape",
    "format",
    "groupby",
    "indent",
    "int",
    "join",
    "last",
    "length",
    "count",
    "list",
    "lower",
    "map",
    "max",
    "min",
    "pprint",
    "reject",
    "rejectattr",
    "replace",
    "reverse",
    "round",
    "safe",
    "select",
    "selectattr",
    "slice",
    "sort",
    "string",
    "striptags",
    "sum",
    "title",
    "tojson",
    "trim",
    "truncate",
    "unique",
    "upper",
    "urlencode",
    "urlize",
    "wordcount",
    "wordwrap",
    "xmlattr",
    # Ansible built-ins
    "b64decode",
    "b64encode",
    "to_uuid",
    "to_json",
    "to_nice_json",
    "from_json",
    "to_yaml",
    "to_nice_yaml",
    "from_yaml",
    "from_yaml_all",
    "basename",
    "dirname",
    "expanduser",
    "path_join",
    "relpath",
    "splitext",
    "win_basename",
    "win_dirname",
    "win_splitdrive",
    "bool",
    "to_datetime",
    "strftime",
    "quote",
    "md5",
    "sha1",
    "checksum",
    "password_hash",
    "hash",
    "regex_replace",
    "regex_escape",
    "regex_search",
    "regex_findall",
    "ternary",
    "mandatory",
    "comment",
    "type_debug",
    "combine",
    "extract",
    "flatten",
    "dict2items",
    "items2dict",
    "subelements",
    "split",
    "urldecode",
    "urlencode",
    "urlsplit",
    "min",
    "max",
    "log",
    "pow",
    "root",
    "unique",
    "intersect",
    "difference",
    "symmetric_difference",
    "union",
    "product",
    "permutations",
    "combinations",
    "human_readable",
    "human_to_bytes",
    "rekey_on_member",
    "zip",
    "zip_longest",
    "json_query",
    "ipaddr",
    "version_compare",
}

PURE_TESTS = {
    # Jinja2 built-in
    "boolean",
    "callable",
    "defined",
    "divisibleby",
    "eq",
    "equalto",
    "==",
    "escaped",
    "even",
    "false",
    "filter",
    "float",
    "ge",
    ">=",
    "gt",
    "greaterthan",
    ">",
    "in",
    "integer",
    "iterable",
    "le",
    "<=",
    "lower",
    "lt",
    "<",
    "lessthan",
    "mapping",
    "ne",
    "!=",
    "none",
    "number",
    "odd",
    "sameas",
    "sequence",
    "string",
    "true",
    "undefined",
    "upper",
    # Ansible built-in
    "match",
    "search",
    "regex",
    "version_compare",
    "version",
    "any",
    "all",
    "truthy",
    "falsy",
    "vault_encrypted",
    "is_abs",
    "abs",
    "issubset",
    "subset",
    "issuperset",
    "superset",
    "contains",
    "isnan",
    "nan",
}
